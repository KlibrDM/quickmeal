"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[2999],{2999:($,p,a)=>{a.r(p),a.d(p,{SearchPageModule:()=>V});var l=a(9972),g=a(4755),I=a(5030),f=a(2443),e=a(3020),y=a(4968),m=a(4004),P=a(727);class w extends P.w0{constructor(r,t){super()}schedule(r,t=0){return this}}const u={setInterval(i,r,...t){const{delegate:n}=u;return null!=n&&n.setInterval?n.setInterval(i,r,...t):setInterval(i,r,...t)},clearInterval(i){const{delegate:r}=u;return((null==r?void 0:r.clearInterval)||clearInterval)(i)},delegate:void 0};var E=a(8737);const v={now:()=>(v.delegate||Date).now(),delegate:void 0};class h{constructor(r,t=h.now){this.schedulerActionCtor=r,this.now=t}schedule(r,t=0,n){return new this.schedulerActionCtor(this,r).schedule(n,t)}}h.now=v.now;const Z=new class A extends h{constructor(r,t=h.now){super(r,t),this.actions=[],this._active=!1}flush(r){const{actions:t}=this;if(this._active)return void t.push(r);let n;this._active=!0;do{if(n=r.execute(r.state,r.delay))break}while(r=t.shift());if(this._active=!1,n){for(;r=t.shift();)r.unsubscribe();throw n}}}(class b extends w{constructor(r,t){super(r,t),this.scheduler=r,this.work=t,this.pending=!1}schedule(r,t=0){var n;if(this.closed)return this;this.state=r;const s=this.id,o=this.scheduler;return null!=s&&(this.id=this.recycleAsyncId(o,s,t)),this.pending=!0,this.delay=t,this.id=null!==(n=this.id)&&void 0!==n?n:this.requestAsyncId(o,this.id,t),this}requestAsyncId(r,t,n=0){return u.setInterval(r.flush.bind(r,this),n)}recycleAsyncId(r,t,n=0){if(null!=n&&this.delay===n&&!1===this.pending)return t;null!=t&&u.clearInterval(t)}execute(r,t){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;const n=this._execute(r,t);if(n)return n;!1===this.pending&&null!=this.id&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))}_execute(r,t){let s,n=!1;try{this.work(r)}catch(o){n=!0,s=o||new Error("Scheduled action threw falsy error")}if(n)return this.unsubscribe(),s}unsubscribe(){if(!this.closed){const{id:r,scheduler:t}=this,{actions:n}=t;this.work=this.state=this.scheduler=null,this.pending=!1,(0,E.P)(n,this),null!=r&&(this.id=this.recycleAsyncId(t,r,null)),this.delay=null,super.unsubscribe()}}});var M=a(4482),C=a(5403),O=a(1884),J=a(2468),Q=a(452),D=a(5955),U=a(8612);const F=["searchInput"];function L(i,r){1&i&&e._UZ(0,"div",11)}function Y(i,r){1&i&&e._UZ(0,"ion-progress-bar",12)}function B(i,r){if(1&i&&(e.TgZ(0,"ion-thumbnail",16),e._UZ(1,"img",17),e.qZA()),2&i){const t=e.oxw().$implicit,n=e.oxw(2);e.ekj("large-avatar",!(null!=n.settings&&n.settings.compactMode)),e.xp6(1),e.Q6J("src",t.image+"/preview",e.LSH)("appImgFallback",t.image)("alt",t.name)}}function N(i,r){if(1&i){const t=e.EpF();e.TgZ(0,"ion-item",14),e.NdJ("click",function(){const o=e.CHM(t).index,d=e.oxw(2);return e.KtG(d.seeDetails(o))}),e.YNc(1,B,2,5,"ion-thumbnail",15),e.TgZ(2,"ion-label"),e._uU(3),e.qZA()()}if(2&i){const t=r.$implicit,n=e.oxw(2);e.xp6(1),e.Q6J("ngIf",!(null!=n.settings&&n.settings.limitedBandwidth)),e.xp6(2),e.Oqu(t.name)}}function R(i,r){if(1&i&&(e.TgZ(0,"ion-list"),e.YNc(1,N,4,2,"ion-item",13),e.qZA()),2&i){const t=e.oxw();e.xp6(1),e.Q6J("ngForOf",t.mealList)}}const j=[{path:"",component:(()=>{class i{constructor(t,n,s){this.dataService=t,this.router=n,this.settingsService=s,this.mealList=[],this.isSearching=!1,this.generalError=!1,this.internetError=!1,this.noDataError=!1}ngOnInit(){this.getSettings()}getSettings(){this.settingsService.settings.subscribe({next:t=>{this.settings=t}})}ngAfterViewInit(){(0,y.R)(this.searchInput.nativeElement,"input").pipe((0,m.U)(t=>t.target.value)).pipe((0,m.U)(t=>(this.isSearching=!0,t))).pipe(function T(i,r=Z){return(0,M.e)((t,n)=>{let s=null,o=null,d=null;const S=()=>{if(s){s.unsubscribe(),s=null;const c=o;o=null,n.next(c)}};function H(){const c=d+i,x=r.now();if(x<c)return s=this.schedule(void 0,c-x),void n.add(s);S()}t.subscribe((0,C.x)(n,c=>{o=c,d=r.now(),s||(s=r.schedule(H,i),n.add(s))},()=>{S(),n.complete()},void 0,()=>{o=s=null}))})}(1500)).pipe((0,O.x)()).subscribe(t=>{if(""===t)return this.mealList=[],this.noDataError=!1,void(this.isSearching=!1);this.dataService.getSearch(t).subscribe({next:n=>{this.mealList=n,this.isSearching=!1,this.internetError=!1,this.generalError=!1,this.noDataError=0===this.mealList.length},error:n=>{this.mealList=[],this.isSearching=!1,0===n.status?this.internetError=!0:this.generalError=!0}})})}seeDetails(t){const n=this.mealList[t];n&&this.router.navigate(["tabs/meal/"+n.id],{state:{meal:n}})}}return i.\u0275fac=function(t){return new(t||i)(e.Y36(J.D),e.Y36(f.F0),e.Y36(Q.g))},i.\u0275cmp=e.Xpm({type:i,selectors:[["app-search"]],viewQuery:function(t,n){if(1&t&&e.Gf(F,5,e.SBq),2&t){let s;e.iGM(s=e.CRH())&&(n.searchInput=s.first)}},decls:16,vars:8,consts:[[1,"bg-white",3,"translucent"],[1,"use-background",3,"fullscreen"],["collapse","condense"],["size","large"],[1,"ion-padding","bg-white"],["label","Search","label-placement","floating","fill","outline","placeholder","Meal name",1,"search-input"],["searchInput",""],["class","progress-bar-placeholder",4,"ngIf"],["type","indeterminate",4,"ngIf"],[4,"ngIf"],[3,"generalError","internetError","noDataError"],[1,"progress-bar-placeholder"],["type","indeterminate"],["class","search-item pointer white-hover",3,"click",4,"ngFor","ngForOf"],[1,"search-item","pointer","white-hover",3,"click"],["slot","start","class","round",3,"large-avatar",4,"ngIf"],["slot","start",1,"round"],[3,"src","appImgFallback","alt"]],template:function(t,n){1&t&&(e.TgZ(0,"ion-header",0)(1,"ion-toolbar")(2,"ion-title"),e._uU(3," Search "),e.qZA()()(),e.TgZ(4,"ion-content",1)(5,"ion-header",2)(6,"ion-toolbar")(7,"ion-title",3),e._uU(8,"Search"),e.qZA()()(),e.TgZ(9,"div",4),e._UZ(10,"ion-input",5,6),e.YNc(12,L,1,0,"div",7),e.YNc(13,Y,1,0,"ion-progress-bar",8),e.qZA(),e.YNc(14,R,2,1,"ion-list",9),e._UZ(15,"app-error-card",10),e.qZA()),2&t&&(e.Q6J("translucent",!0),e.xp6(4),e.Q6J("fullscreen",!0),e.xp6(8),e.Q6J("ngIf",!n.isSearching),e.xp6(1),e.Q6J("ngIf",n.isSearching),e.xp6(1),e.Q6J("ngIf",n.mealList.length),e.xp6(1),e.Q6J("generalError",n.generalError)("internetError",n.internetError)("noDataError",n.noDataError))},dependencies:[l.W2,l.Gu,l.pK,l.Ie,l.Q$,l.q_,l.X7,l.Bs,l.wd,l.sr,l.j9,g.sg,g.O5,D.V,U.Z],styles:[".progress-bar-placeholder[_ngcontent-%COMP%]{height:3px}.search-input[_ngcontent-%COMP%]{margin-bottom:8px}.large-avatar[_ngcontent-%COMP%]{width:80px;height:80px}.round[_ngcontent-%COMP%] > img[_ngcontent-%COMP%]{border-radius:100%}[_nghost-%COMP%]   ion-list[_ngcontent-%COMP%]{padding-top:0}"]}),i})()}];let z=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=e.oAB({type:i}),i.\u0275inj=e.cJS({imports:[f.Bz.forChild(j),f.Bz]}),i})();var G=a(4466);let V=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=e.oAB({type:i}),i.\u0275inj=e.cJS({imports:[l.Pc,g.ez,I.u5,z,G.m]}),i})()}}]);